<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.aishang.dao.ICategoryDao">

    <resultMap id="categoryAndCategorySecond" type="CategoryExt">
        <id column="cid" property="cid"></id>
        <result column="cname" property="cname"></result>
        <collection property="categorySecondList" ofType="CategorySecond">
            <id column="csid" property="csid"></id>
            <result column="csname" property="csname"></result>
            <result column="cid" property="cid"></result>
        </collection>
    </resultMap>

    <resultMap id="CsExt" type="CategorySecondExt">
        <id column="csid" property="csid"></id>
        <result column="csname" property="csname"></result>
        <collection property="productList" ofType="Product">
            <id column="pid" property="pid"></id>
            <result column="pname" property="pName"></result>
            <result column="market_price" property="marketPrice"></result>
            <result column="shop_price" property="shopPrice"></result>
            <result column="pdesc" property="pDesc"></result>
            <result column="is_hot" property="isHot"></result>
            <result column="pdate" property="pDate"></result>
            <result column="csid" property="csid"></result>
            <result column="image" property="image"></result>
        </collection>
    </resultMap>

    <select id="getCategoryAndCategorySecond" resultMap="categoryAndCategorySecond" >
          select category.*,categorysecond.*
          from category
          left join categorysecond
          on category.cid = categorysecond.cid
    </select>

    <select id="getIsHotProductListByCid" resultMap="CsExt" parameterType="Integer">
          select categorysecond.*,product.*
          from categorysecond
          left join product
          on categorysecond.csid=product.csid
          where is_hot=1 and cid=#{cid}
          limit 0,6
    </select>
</mapper>